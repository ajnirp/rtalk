<% current_user = cookies[:user_name] %>
<% user_count = @room.get_user_list.length %>

<p>Welcome, <strong><%= current_user %></strong>! Click the <strong>Leave Room</strong> button when you want to leave the chat room. If everyone leaves the chat room, it will be removed and all your chat logs will be destroyed.</p>

<button id="copy_clip" class="btn btn-warning">Copy Room Key To Clipboard</button>
<%= clippy("sample").html_safe %>

<p>
	<strong><%= pluralize(user_count, 'user') %></strong> chatting right now:
</p>

<%= render 'show_users' %>

<div class="row-fluid">
	<ul id="chat">
		<% @room.messages.each do |msg| %>
			<%= render partial: 'message', locals: {message: msg} %>
		<% end %>
	</ul>
</div>

<div class="form-horizontal">
	<%= form_for Message.new, remote: true, id: "new_message" do |f| %>
		<%= f.text_field :content, style: "width:600px", placeholder: "Say something..." %>
		<%= f.hidden_field :room_id, value: @room.id %>
		<%= f.hidden_field :user_name, value: current_user %>
		<%= f.submit "Send", class: "btn btn-info" %>
	<% end %>
</div>

<div style="margin-top:15px">
	<%= link_to "Leave Room", room_path(@room), method: :delete, class: "btn btn-danger" %>
	<%#= link_to "Help", "#", :class => "btn btn-success" %>
</div>

<%= subscribe_to room_path(@room) %>